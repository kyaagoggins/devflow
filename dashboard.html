<!DOCTYPE html>
<style>
  /* styling for header */
  .rectangle-div {
    width: 30%;
    position: relative;
    border-radius: 33px;
    background-color: #fff;
    border: 3px solid #d2c6ce;
    box-sizing: border-box;
    height: 38px;
  }

  body {
    line-height: normal;
  }

  /* styling for left side nav bar */
  .navBar {
    display: flex;
    align-items: center;
    justify-content: flex-end;
  }

  .hidden {
    display: none;
  }

  .login-page,
  .dashboard-page,
  .effort-tracking-page,
  .requirements-tracking-page {
    padding: 20px;
  }

  .userButton,
  .settingsButton,
  .downloadButton {
    margin-top: 1% !important;
    margin-bottom: 1% !important;
  }

  .userButton {
    margin-left: 10px !important;
    margin-right: 1% !important;
  }

  .settingsButton {
    margin-left: 10px !important;
    margin-right: 10px !important;
  }

  .downloadButton {
    margin-left: 1% !important;
    margin-right: 10px !important;
  }

  /* dashboard header text */
  .title {
    font-family: Inter;
    padding-right: 46%;
  }

  /* general button styling  */
  .btn {
    background: none;
    border: none;
    outline: none;
    cursor: pointer;
    padding: 0;
    margin-right: 8px;
    font-size: 16px;
    color: #888;
  }

  /* search bar styling */
  .searchInput {
    border: none;
    outline: none;
    flex: 1;
    font-size: 14px;
    font-family: Inter;
    width: 50%;
  }

  .searchButton {
    padding: 1% !important;
  }

  .navButton {
    padding-right: 1%;
  }

  /* dashboard main content */
  .mainContent {
    height: 88%;
    width: 82%;
    margin-left: 40px;
    margin-top: 20px;
    position: absolute;
    background: #efe6e6;
    display: flex;
  }

  /* team content div */
  .teamContent {
    width: 20%;
    height: 91.5%;
    background: white;
    margin-top: 50px;
    display: flex;
    position: absolute;
    margin-left: 20px;
    border-radius: 45px;
    flex-direction: column;
    align-items: center;
    justify-content: space-between;
  }

  .projectDesc {
    border-radius: 45px;
    display: flex;
    position: absolute;
    background: white;
    width: 31%;
    height: 38%;
    margin-left: 23%;
    margin-top: 50px;
  }

  .deadlines {
    display: flex;
    position: absolute;
    background: white;
    width: 20%;
    height: 38%;
    border-radius: 45px;
    margin-left: 56%;
    margin-top: 50px;
  }

  .risks {
    display: flex;
    position: absolute;
    background: white;
    width: 20%;
    height: 38%;
    border-radius: 45px;
    margin-left: 78%;
    margin-top: 50px;
    flex-direction: column;
    flex-wrap: wrap;
    align-content: center;
    justify-content: flex-start;
  }

  .tasks {
    display: flex;
    position: absolute;
    background: white;
    margin-left: 23%;
    width: 75%;
    height: 50%;
    border-radius: 45px;
    margin-top: 25%;
    font-family: Inter, sans-serif;
  }

  .teams,
  .riskContent {
    padding: 10px 20px;
    overflow-y: auto;
    flex: 1;
  }

  .teamTitle,
  .riskTitle,
  .taskHeader,
  .projectTitle {
    color: black;
    font-size: 20px;
    font-family: Inter;
    font-weight: 700;
    word-wrap: break-word;
  }

  .teamMember,
  .riskText {
    color: black;
    font-size: 16px;
    font-family: Inter;
    font-weight: 400;
    word-wrap: break-word;
  }

  .taskContainer {
    width: 100%;
    padding: 30px;
    display: flex;
    flex-direction: column;
    gap: 10px;
  }

  .taskHeaders,
  .taskRow {
    display: grid;
    grid-template-columns: 2fr 1fr 1fr 1fr;
    gap: 10px;
  }

  .taskCell {
    font-weight: 400;
    font-size: 16px;
    color: #333;
  }

  .projectInfo {
    padding: 20px;
    display: flex;
    flex-direction: column;
    gap: 10px;
    width: 70%;
  }

  .projectDescription {
    font-size: 16px;
    font-weight: 400;
    font-family: Inter, sans-serif;
    color: #444;
  }

  .projectPriority {
    font-size: 16px;
    font-weight: 500;
    font-family: Inter, sans-serif;
    color: #b30000;
  }

  .projectGraph {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    width: 30%;
    padding-right: 20px;
  }

  .progressBarContainer {
    width: 100%;
    height: 15px;
    background-color: #eee;
    border-radius: 10px;
    overflow: hidden;
    margin-bottom: 10px;
  }

  .progressBar {
    height: 100%;
    width: 65%; /* Set dynamically with JS */
    background-color: #4caf50;
    transition: width 0.3s ease-in-out;
    border-radius: 10px;
  }

  .progressLabel {
    font-size: 14px;
    color: #333;
  }
</style>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="initial-scale=1, width=device-width" />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css"
    />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700&display=swap"
      rel="stylesheet"
    />
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  </head>

  <body>
    <div id="sidebarContainer"></div>

    <div class="navBar">
      <button class="btn navButton"><i class="fa fa-bars"></i></button>
      <h1 class="title">Dashboard</h1>
      <div class="rectangle-div">
        <button class="btn searchButton"><i class="fa fa-search"></i></button>
        <input type="text" class="searchInput" placeholder="Search..." />
      </div>
      <button class="btn downloadButton" id="downloadButton">
        <i class="fa fa-download"></i>
      </button>
      <button
        class="btn settingsButton"
        id="settingsButton"
        onclick="window.location.href='Structure.html'"
      >
        <i class="fa fa-cog"></i>
      </button>
      <button
        class="btn userButton"
        id="userButton"
        onclick="window.location.href='input.html'"
      >
        <i class="fa fa-user-circle"></i>
      </button>
    </div>

    <div class="mainContent">
      <div class="teamContent">
        <details>
          <summary class="teamTitle" id="managerTitle" style="padding-top: 10%">
            Project Manager
          </summary>
          <p class="teamMember" id="managerName">Jane Doe</p>
        </details>
        <div id="teams"></div>
      </div>
      <div class="projectDesc">
        <div class="projectInfo">
          <p class="projectTitle" id="projectTitle"></p>
          <p class="projectDescription" id="projectDescription"></p>
          <p class="projectPriority" id="projectPriority"></p>
        </div>
        <div class="projectGraph">
          <div class="progressBarContainer">
            <div class="progressBar" id="progressBar"></div>
          </div>
          <p class="progressLabel" id="progressLabel"></p>
        </div>
      </div>
      <div class="deadlines"></div>
      <div class="risks">
        <p class="riskTitle">Risks</p>
        <div id="riskContent"></div>
      </div>
      <div class="tasks">
        <div class="taskContainer">
          <div class="taskHeaders">
            <p class="taskHeader">Tasks</p>
            <p class="taskHeader">Due</p>
            <p class="taskHeader">Priority</p>
            <p class="taskHeader">Team</p>
          </div>
          <div class="taskContent" id="taskContent"></div>
        </div>
      </div>
    </div>

    <script>
      $(document).ready(function () {
        $.get("/navigation.html", function (html) {
          $("#sidebarContainer").html(html); //show sidebar

          $("body").css("margin-left", "300px");
        });

        //function to handle nav button functionality
        $(".navButton").on("click", function () {
          //if the sidebar is not shown yet, get the html
          if ($("body").css("margin-left") === "0px") {
            $.get("/navigation.html", function (html) {
              $("#sidebarContainer").html(html); //show sidebar
              $(".title").css("padding-right", "47%");
              $("body").css("margin-left", "300px");
              $(".mainContent").css("margin-left", "40px");
              $(".mainContent").css("width", "82%");
              $(".tasks").css("margin-top", "25%");
            });
          } else {
            //the sidebar is open, clicking will remove it
            $("body").css("margin-left", "0px");
            $("#sidebarContainer").html("");
            $(".title").css("padding-right", "50%");
            $(".mainContent").css("margin-left", "0px");
            $(".mainContent").css("width", "100%");
            $(".tasks").css("margin-top", "20.5%");
          }
        });
      });

      function getData() {
        const data = JSON.parse(localStorage.getItem("projectInfo"));
        console.log(data);

        displayTeams(data.team);
        displayRisks(data.risks);

        const sampleTasks = [
          {
            name: "Write documentation",
            due: "2025-04-15",
            priority: "High",
            team: "Dev",
          },
          {
            name: "UI update",
            due: "2025-04-18",
            priority: "Medium",
            team: "Design",
          },
        ];

        displayTasks(sampleTasks);

        const exampleProject = {
          title: "Project Phoenix",
          description:
            "This project is focused on revamping the UI of our dashboard system.",
          priority: "High",
          progress: 65,
        };

        displayProjectInfo(exampleProject);
      }

      function displayProjectInfo(projData) {
        document.getElementById("projectTitle").textContent = projData.title;
        document.getElementById("projectDescription").textContent =
          projData.description;
        document.getElementById("projectPriority").textContent =
          "Priority: " + projData.priority;
        document.getElementById("progressBar").style.width =
          projData.progress + "%";
        document.getElementById("progressLabel").textContent =
          projData.progress + "% Complete";
      }

      //function that gets the task data and displays it on the page
      function displayTasks(taskData) {
        const taskContent = document.getElementById("taskContent");

        taskData.forEach((task) => {
          const row = document.createElement("div");
          row.className = "taskRow";

          const taskCell = document.createElement("p");
          taskCell.className = "taskCell";
          taskCell.textContent = task.name;

          const dueCell = document.createElement("p");
          dueCell.className = "taskCell";
          dueCell.textContent = task.due;

          const priorityCell = document.createElement("p");
          priorityCell.className = "taskCell";
          priorityCell.textContent = task.priority;

          const teamCell = document.createElement("p");
          teamCell.className = "taskCell";
          teamCell.textContent = task.team;

          row.append(taskCell, dueCell, priorityCell, teamCell);
          taskContent.appendChild(row);
        });
      }

      //function that gets the risk data and displays it on the page
      function displayRisks(riskData) {
        const container = document.getElementById("riskContent");

        const risks = riskData.split(",").map((risk) => risk.trim());

        risks.forEach((risk) => {
          const p = document.createElement("p");
          p.className = "riskText";
          p.textContent = risk;
          container.appendChild(p);
        });
      }

      function displayTeams(teamData) {
        const container = document.getElementById("teams");

        teamData.forEach((team) => {
          const details = document.createElement("details");

          const summary = document.createElement("summary");
          summary.className = "teamTitle";
          summary.textContent = team;

          details.appendChild(summary);

          // team.members.forEach((member) => {
          //   const p = document.createElement("p");
          //   p.className = "teamMember";
          //   p.textContent = member;
          //   details.appendChild(p);
          // });

          //container.appendChild(details);
        });
      }
    </script>
  </body>
</html>
